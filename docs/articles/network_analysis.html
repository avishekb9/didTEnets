<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Network Analysis with didTEnets â€¢ didTEnets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Network Analysis with didTEnets">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">didTEnets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to didTEnets</a></li>
    <li><a class="dropdown-item" href="../articles/network_analysis.html">Network Analysis with didTEnets</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="dropdown-item" href="../news/index.html">Version 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/avishekb9/didTEnets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="network_analysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Network Analysis with didTEnets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/avishekb9/didTEnets/blob/HEAD/vignettes/network_analysis.Rmd" class="external-link"><code>vignettes/network_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>network_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="network-analysis-with-didtenets">Network Analysis with didTEnets<a class="anchor" aria-label="anchor" href="#network-analysis-with-didtenets"></a>
</h2>
<p>This vignette demonstrates the network analysis capabilities of the <code>didTEnets</code> package, focusing on transfer entropy calculation, network weight construction, and network evolution visualization.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/avishekb9/didTEnets" class="external-link">didTEnets</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'igraph'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     as_data_frame, groups, union</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     decompose, spectrum</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="understanding-transfer-entropy">Understanding Transfer Entropy<a class="anchor" aria-label="anchor" href="#understanding-transfer-entropy"></a>
</h3>
<p>Transfer entropy (TE) is a model-free measure of directed information flow between time series. Unlike correlation, which is symmetric, transfer entropy captures the direction of information flow.</p>
<div class="section level4">
<h4 id="basic-transfer-entropy-calculation">Basic Transfer Entropy Calculation<a class="anchor" aria-label="anchor" href="#basic-transfer-entropy-calculation"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate sample data with known relationship</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">source</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">0.8</span><span class="op">)</span>  <span class="co"># target influenced by source</span></span>
<span></span>
<span><span class="co"># Calculate transfer entropy in both directions</span></span>
<span><span class="va">te_source_to_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_enhanced_transfer_entropy.html">calculate_enhanced_transfer_entropy</a></span><span class="op">(</span><span class="va">source</span>, <span class="va">target</span><span class="op">)</span></span>
<span><span class="va">te_target_to_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_enhanced_transfer_entropy.html">calculate_enhanced_transfer_entropy</a></span><span class="op">(</span><span class="va">target</span>, <span class="va">source</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"TE from source to target:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">te_source_to_target</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"TE from target to source:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">te_target_to_source</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<p>The enhanced transfer entropy function in <code>didTEnets</code> includes several innovations:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Quantile Conditioning</strong>: Focus on extreme events (crisis periods)</li>
<li>
<strong>Volatility Scaling</strong>: Incorporate market volatility for realistic magnitudes</li>
<li>
<strong>Robust Handling</strong>: Deal with missing data and insufficient observations</li>
</ol>
</div>
<div class="section level4">
<h4 id="quantile-conditioning-for-crisis-analysis">Quantile Conditioning for Crisis Analysis<a class="anchor" aria-label="anchor" href="#quantile-conditioning-for-crisis-analysis"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with crisis periods</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">normal_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">crisis_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>  <span class="co"># More volatile, negative bias</span></span>
<span><span class="va">source_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">normal_period</span>, <span class="va">crisis_period</span><span class="op">)</span></span>
<span><span class="va">target_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0.6</span> <span class="op">*</span> <span class="va">crisis_period</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate TE focusing on crisis events (bottom 10% quantile)</span></span>
<span><span class="va">te_crisis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_enhanced_transfer_entropy.html">calculate_enhanced_transfer_entropy</a></span><span class="op">(</span><span class="va">source_series</span>, <span class="va">target_series</span>, </span>
<span>                                               quantile_threshold <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate TE focusing on normal periods (50th percentile)</span></span>
<span><span class="va">te_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_enhanced_transfer_entropy.html">calculate_enhanced_transfer_entropy</a></span><span class="op">(</span><span class="va">source_series</span>, <span class="va">target_series</span>, </span>
<span>                                               quantile_threshold <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"TE during crisis events:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">te_crisis</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"TE during normal periods:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">te_normal</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="network-weight-construction">Network Weight Construction<a class="anchor" aria-label="anchor" href="#network-weight-construction"></a>
</h3>
<p>Network weights determine how policy spillovers and contagion effects propagate through the financial system. The <code>didTEnets</code> package supports multiple weight types:</p>
<div class="section level4">
<h4 id="correlation-based-weights">1. Correlation-Based Weights<a class="anchor" aria-label="anchor" href="#correlation-based-weights"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using sample data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample_financial_returns</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate correlation-based weights</span></span>
<span><span class="va">cor_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_network_weights.html">calculate_network_weights</a></span><span class="op">(</span><span class="va">sample_financial_returns</span>, <span class="st">"correlation"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the weight matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_weights</span><span class="op">$</span><span class="va">correlation</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Correlation-based weights capture co-movement patterns between markets. Higher correlations indicate stronger connections.</p>
</div>
<div class="section level4">
<h4 id="geographic-weights">2. Geographic Weights<a class="anchor" aria-label="anchor" href="#geographic-weights"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate geographic weights with custom regions</span></span>
<span><span class="va">custom_regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  europe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GBR"</span>, <span class="st">"DEU"</span>, <span class="st">"FRA"</span><span class="op">)</span>,</span>
<span>  asia_pacific <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JPN"</span>, <span class="st">"AUS"</span><span class="op">)</span>,</span>
<span>  americas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USA"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_network_weights.html">calculate_network_weights</a></span><span class="op">(</span><span class="va">sample_financial_returns</span>, <span class="st">"geographic"</span>,</span>
<span>                                       geographic_groups <span class="op">=</span> <span class="va">custom_regions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">geo_weights</span><span class="op">$</span><span class="va">geographic</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Geographic weights assume that countries in the same region have stronger connections due to trade, cultural, and institutional similarities.</p>
</div>
<div class="section level4">
<h4 id="economic-similarity-weights">3. Economic Similarity Weights<a class="anchor" aria-label="anchor" href="#economic-similarity-weights"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate economic similarity weights (based on volatility patterns)</span></span>
<span><span class="va">econ_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_network_weights.html">calculate_network_weights</a></span><span class="op">(</span><span class="va">sample_financial_returns</span>, <span class="st">"economic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">econ_weights</span><span class="op">$</span><span class="va">economic</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Economic similarity weights use market volatility patterns as a proxy for economic development level and market maturity.</p>
</div>
<div class="section level4">
<h4 id="composite-weights">4. Composite Weights<a class="anchor" aria-label="anchor" href="#composite-weights"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate all weight types and create composite</span></span>
<span><span class="va">all_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_network_weights.html">calculate_network_weights</a></span><span class="op">(</span><span class="va">sample_financial_returns</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The composite weights combine multiple sources of information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">all_weights</span><span class="op">$</span><span class="va">composite</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="transfer-entropy-matrix-calculation">Transfer Entropy Matrix Calculation<a class="anchor" aria-label="anchor" href="#transfer-entropy-matrix-calculation"></a>
</h3>
<p>For network analysis, we calculate transfer entropy between all pairs of countries for different time periods and market conditions:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define analysis periods</span></span>
<span><span class="va">returns_data</span> <span class="op">&lt;-</span> <span class="va">sample_financial_returns</span></span>
<span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">returns_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">period_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Pre_Crisis"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n_obs</span> <span class="op">*</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  <span class="st">"Crisis"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n_obs</span> <span class="op">*</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n_obs</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  <span class="st">"Post_Crisis"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n_obs</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">:</span><span class="va">n_obs</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate TE matrices for different periods and quantiles</span></span>
<span><span class="va">te_matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_te_matrices_by_period.html">calculate_te_matrices_by_period</a></span><span class="op">(</span><span class="va">returns_data</span>, <span class="va">period_breaks</span>, </span>
<span>                                             quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">te_matrices</span><span class="op">)</span></span></code></pre></div>
<p>Each matrix shows directed information flows between countries: - <strong>Rows</strong>: Source countries (information senders) - <strong>Columns</strong>: Target countries (information receivers) - <strong>Values</strong>: Transfer entropy strength</p>
</div>
<div class="section level3">
<h3 id="network-statistics-and-evolution">Network Statistics and Evolution<a class="anchor" aria-label="anchor" href="#network-statistics-and-evolution"></a>
</h3>
<div class="section level4">
<h4 id="basic-network-statistics">Basic Network Statistics<a class="anchor" aria-label="anchor" href="#basic-network-statistics"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate comprehensive network statistics</span></span>
<span><span class="va">network_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_network_statistics.html">calculate_network_statistics</a></span><span class="op">(</span><span class="va">te_matrices</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View summary statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">network_stats</span><span class="op">)</span></span></code></pre></div>
<p>Key network statistics include: - <strong>Density</strong>: Proportion of possible connections that exist - <strong>Transitivity</strong>: Clustering coefficient (Aâ†’Bâ†’C implies Aâ†’C) - <strong>Average Strength</strong>: Mean TE flow strength - <strong>Max TE</strong>: Strongest individual connection</p>
</div>
<div class="section level4">
<h4 id="contagion-analysis">Contagion Analysis<a class="anchor" aria-label="anchor" href="#contagion-analysis"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyze network evolution to establish contagion</span></span>
<span><span class="va">crisis_stats</span> <span class="op">&lt;-</span> <span class="va">network_stats</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Quantile</span> <span class="op">==</span> <span class="st">"Q0.1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># Focus on crisis quantile</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Period</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">crisis_stats</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pre_crisis</span> <span class="op">&lt;-</span> <span class="va">crisis_stats</span><span class="op">[</span><span class="va">crisis_stats</span><span class="op">$</span><span class="va">Period</span> <span class="op">==</span> <span class="st">"Pre_Crisis"</span>, <span class="op">]</span></span>
<span>  <span class="va">crisis</span> <span class="op">&lt;-</span> <span class="va">crisis_stats</span><span class="op">[</span><span class="va">crisis_stats</span><span class="op">$</span><span class="va">Period</span> <span class="op">==</span> <span class="st">"Crisis"</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pre_crisis</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">crisis</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">density_change</span> <span class="op">&lt;-</span> <span class="va">crisis</span><span class="op">$</span><span class="va">Density</span> <span class="op">-</span> <span class="va">pre_crisis</span><span class="op">$</span><span class="va">Density</span></span>
<span>    <span class="va">mean_te_change</span> <span class="op">&lt;-</span> <span class="va">crisis</span><span class="op">$</span><span class="va">Mean_TE</span> <span class="op">-</span> <span class="va">pre_crisis</span><span class="op">$</span><span class="va">Mean_TE</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Network density change:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">density_change</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean TE change:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean_te_change</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">density_change</span> <span class="op">&gt;</span> <span class="fl">0.05</span> <span class="op">||</span> <span class="va">mean_te_change</span> <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"âœ“ CONTAGION ESTABLISHED\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"â—‹ Limited evidence of contagion\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="network-visualization">Network Visualization<a class="anchor" aria-label="anchor" href="#network-visualization"></a>
</h3>
<div class="section level4">
<h4 id="network-evolution-plots">Network Evolution Plots<a class="anchor" aria-label="anchor" href="#network-evolution-plots"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create network comparison visualizations</span></span>
<span><span class="va">network_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_network_comparison.html">create_network_comparison</a></span><span class="op">(</span><span class="va">te_matrices</span>, threshold <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display evolution across periods</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">network_plots</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">network_plots</span><span class="op">$</span><span class="va">Pre_Crisis</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">network_plots</span><span class="op">$</span><span class="va">Crisis</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">network_plots</span><span class="op">$</span><span class="va">Post_Crisis</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="transfer-entropy-heatmaps">Transfer Entropy Heatmaps<a class="anchor" aria-label="anchor" href="#transfer-entropy-heatmaps"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create TE heatmaps for different periods</span></span>
<span><span class="va">te_heatmaps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_te_heatmaps.html">create_te_heatmaps</a></span><span class="op">(</span><span class="va">te_matrices</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display heatmaps</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">te_heatmaps</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">te_heatmaps</span><span class="op">$</span><span class="va">Pre_Crisis</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">te_heatmaps</span><span class="op">$</span><span class="va">Crisis</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="custom-network-visualization">Custom Network Visualization<a class="anchor" aria-label="anchor" href="#custom-network-visualization"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create custom network plot</span></span>
<span><span class="va">create_custom_network_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">te_matrix</span>, <span class="va">title</span> <span class="op">=</span> <span class="st">"Financial Network"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Convert to igraph object</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">te_matrix</span>, mode <span class="op">=</span> <span class="st">"directed"</span>, </span>
<span>                                  weighted <span class="op">=</span> <span class="cn">TRUE</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Set node attributes</span></span>
<span>  <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">g</span>, mode <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">+</span> <span class="fl">10</span></span>
<span>  <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USA"</span>, <span class="st">"GBR"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"red"</span>,</span>
<span>    <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DEU"</span>, <span class="st">"FRA"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"blue"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"orange"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create plot</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">"stress"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_arc.html" class="external-link">geom_edge_arc</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>width <span class="op">=</span> <span class="va">weight</span>, alpha <span class="op">=</span> <span class="va">weight</span><span class="op">)</span>,</span>
<span>                 arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">size</span>, color <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html" class="external-link">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>, fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/scale_edge_width.html" class="external-link">scale_edge_width_continuous</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/scale_edge_alpha.html" class="external-link">scale_edge_alpha_continuous</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.8</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_continuous</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_color_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply to crisis period matrix</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"Crisis_Q0.1"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">te_matrices</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">crisis_plot</span> <span class="op">&lt;-</span> <span class="fu">create_custom_network_plot</span><span class="op">(</span><span class="va">te_matrices</span><span class="op">$</span><span class="va">Crisis_Q0.1</span>, </span>
<span>                                           <span class="st">"Crisis Period Network"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">crisis_plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="advanced-network-analysis">Advanced Network Analysis<a class="anchor" aria-label="anchor" href="#advanced-network-analysis"></a>
</h3>
<div class="section level4">
<h4 id="centrality-measures">Centrality Measures<a class="anchor" aria-label="anchor" href="#centrality-measures"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate network centrality measures</span></span>
<span><span class="va">calculate_centrality_measures</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">te_matrix</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">te_matrix</span>, mode <span class="op">=</span> <span class="st">"directed"</span>, </span>
<span>                                  weighted <span class="op">=</span> <span class="cn">TRUE</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">centrality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Country <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>,</span>
<span>    InDegree <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">g</span>, mode <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span>,</span>
<span>    OutDegree <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">g</span>, mode <span class="op">=</span> <span class="st">"out"</span><span class="op">)</span>,</span>
<span>    InStrength <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/strength.html" class="external-link">strength</a></span><span class="op">(</span><span class="va">g</span>, mode <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span>,</span>
<span>    OutStrength <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/strength.html" class="external-link">strength</a></span><span class="op">(</span><span class="va">g</span>, mode <span class="op">=</span> <span class="st">"out"</span><span class="op">)</span>,</span>
<span>    Betweenness <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/betweenness.html" class="external-link">betweenness</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>,</span>
<span>    PageRank <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/page_rank.html" class="external-link">page_rank</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">vector</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">centrality_df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply to crisis matrix</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"Crisis_Q0.1"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">te_matrices</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">centrality_measures</span> <span class="op">&lt;-</span> <span class="fu">calculate_centrality_measures</span><span class="op">(</span><span class="va">te_matrices</span><span class="op">$</span><span class="va">Crisis_Q0.1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">centrality_measures</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="network-persistence-analysis">Network Persistence Analysis<a class="anchor" aria-label="anchor" href="#network-persistence-analysis"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyze which connections persist across periods</span></span>
<span><span class="va">analyze_network_persistence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">te_matrices</span>, <span class="va">threshold</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Get crisis period matrices</span></span>
<span>  <span class="va">crisis_matrices</span> <span class="op">&lt;-</span> <span class="va">te_matrices</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Q0.1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">te_matrices</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Binarize matrices based on threshold</span></span>
<span>  <span class="va">binary_matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">crisis_matrices</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">threshold</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate persistence (connections present in all periods)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">binary_matrices</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">persistence_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="va">binary_matrices</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">binary_matrices</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Find highly persistent connections (present in &gt;75% of periods)</span></span>
<span>    <span class="va">persistent_connections</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">persistence_matrix</span> <span class="op">&gt;</span> <span class="fl">0.75</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">persistent_connections</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Highly persistent connections:\n"</span><span class="op">)</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">persistent_connections</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">from</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">persistence_matrix</span><span class="op">)</span><span class="op">[</span><span class="va">persistent_connections</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="va">to</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">persistence_matrix</span><span class="op">)</span><span class="op">[</span><span class="va">persistent_connections</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">from</span>, <span class="st">"â†’"</span>, <span class="va">to</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Analyze persistence</span></span>
<span><span class="fu">analyze_network_persistence</span><span class="op">(</span><span class="va">te_matrices</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h3>
<div class="section level4">
<h4 id="data-quality">1. Data Quality<a class="anchor" aria-label="anchor" href="#data-quality"></a>
</h4>
<ul>
<li>Ensure sufficient observations for reliable TE estimation (minimum 30-50 per period)</li>
<li>Handle missing data appropriately</li>
<li>Check for structural breaks in the data</li>
</ul>
</div>
<div class="section level4">
<h4 id="parameter-selection">2. Parameter Selection<a class="anchor" aria-label="anchor" href="#parameter-selection"></a>
</h4>
<ul>
<li>Choose quantile thresholds based on research question (0.1 for crisis, 0.5 for normal)</li>
<li>Set appropriate TE thresholds for network visualization (typically 0.01-0.05)</li>
<li>Consider lag structure for TE calculation</li>
</ul>
</div>
<div class="section level4">
<h4 id="interpretation">3. Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h4>
<ul>
<li>Remember that TE measures information flow, not causation</li>
<li>Consider economic mechanisms behind network connections</li>
<li>Validate results with known financial relationships</li>
</ul>
</div>
<div class="section level4">
<h4 id="computational-considerations">4. Computational Considerations<a class="anchor" aria-label="anchor" href="#computational-considerations"></a>
</h4>
<ul>
<li>TE calculation can be computationally intensive for large networks</li>
<li>Consider parallel processing for multiple periods/quantiles</li>
<li>Cache results for repeated analysis</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>The network analysis capabilities of <code>didTEnets</code> provide powerful tools for understanding financial contagion and policy transmission mechanisms. By combining transfer entropy with network analysis, researchers can:</p>
<ol style="list-style-type: decimal">
<li>Identify key transmission channels during crisis periods</li>
<li>Measure the evolution of financial networks over time</li>
<li>Quantify the importance of different countries as sources or receivers of risk</li>
<li>Visualize complex network structures in an intuitive way</li>
</ol>
<p>These insights are crucial for designing effective policy interventions and understanding systemic risk in interconnected financial systems.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/avishekb9" class="external-link">Avishek Bhandari</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
